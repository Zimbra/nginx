--- ngx_http_request.c	2012-04-24 06:14:27.000000000 -0500
+++ ngx_http_request.c	2012-04-24 06:14:27.000000000 -0500
@@ -3115,6 +3115,11 @@
     u_char              *p;
     ngx_http_request_t  *r;
     ngx_http_log_ctx_t  *ctx;
+    ngx_uint_t          remote_port=0;
+    struct sockaddr_in         *sin;
+#if (NGX_HAVE_INET6)
+    struct sockaddr_in6        *sin6;
+#endif
 
     if (log->action) {
         p = ngx_snprintf(buf, len, " while %s", log->action);
@@ -3124,15 +3129,32 @@
 
     ctx = log->data;
 
-    p = ngx_snprintf(buf, len, ", client: %V", &ctx->connection->addr_text);
-    len -= p - buf;
-
     r = ctx->request;
-
     if (r) {
+        switch (r->connection->sockaddr->sa_family) {
+    #if (NGX_HAVE_INET6)
+        case AF_INET6:
+            sin6 = (struct sockaddr_in6 *) r->connection->sockaddr;
+            remote_port = ntohs(sin6->sin6_port);
+            break;
+    #endif
+    
+        default: /* AF_INET */
+            sin = (struct sockaddr_in *) r->connection->sockaddr;
+            remote_port = ntohs(sin->sin_port);
+            break;
+        }
+    
+        if (remote_port && remote_port < 65536) {
+          p = ngx_snprintf(buf, len, ", client: %V:%ui", &ctx->connection->addr_text,remote_port);
+        } else {
+          p = ngx_snprintf(buf, len, ", client: %V", &ctx->connection->addr_text);
+        }
+        len -= p - buf;
+    
         return r->log_handler(r, ctx->current_request, p, len);
-
     } else {
+        p = ngx_snprintf(buf, len, ", client: %V", &ctx->connection->addr_text);
         p = ngx_snprintf(p, len, ", server: %V",
                          &ctx->connection->listening->addr_text);
     }
